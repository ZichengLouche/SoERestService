SQL_QUERY_TEMPLATE=select tt.title industryName,tt.idKey industryId,t1.idKey level1Id,t1.sequenceNumber level1Seq,t1.title level1Title,t1.content level1Content,t2.idKey level2Id,t2.sequenceNumber level2Seq,t2.title level2Title,t2.content level2Content,t3.idKey level3Id,t3.sequenceNumber level3Seq,t3.title level3Title,t3.content level3Content, t2.idParent level2Parent,t3.idParent level3Parent,CASE WHEN (case WHEN IFNULL(tt.lastUpdated,0)=IFNULL(t1.lastUpdated,0) AND IFNULL(t1.lastUpdated,0)=0 THEN 0 WHEN IFNULL(tt.lastUpdated,0)>=IFNULL(t1.lastUpdated,0) THEN tt.lastUpdated else t1.lastUpdated END )>=(case WHEN IFNULL(t2.lastUpdated,0)=IFNULL(t3.lastUpdated,0) and IFNULL(t3.lastUpdated,0)=0  THEN 0 WHEN IFNULL(t2.lastUpdated,0)>=IFNULL(t3.lastUpdated,0) THEN t2.lastUpdated else t3.lastUpdated end)  THEN (case WHEN IFNULL(tt.lastUpdated,0)=IFNULL(t1.lastUpdated,0) AND IFNULL(t1.lastUpdated,0)=0 THEN 0 WHEN IFNULL(tt.lastUpdated,0)>=IFNULL(t1.lastUpdated,0) THEN tt.lastUpdated else t1.lastUpdated END ) ELSE (case WHEN IFNULL(t2.lastUpdated,0)=IFNULL(t3.lastUpdated,0) and IFNULL(t3.lastUpdated,0)=0  THEN 0 WHEN IFNULL(t2.lastUpdated,0)>=IFNULL(t3.lastUpdated,0) THEN t2.lastUpdated else t3.lastUpdated end) END  lastUpdate  from (select * from {0}.pov_template t where t.idParent=0 and t.level=0 ) tt INNER JOIN {0}.pov_template t1 on (t1.idParent=tt.idKey and t1.level=1) LEFT JOIN {0}.pov_template t2 on (t2.idParent=t1.idKey and t2.level=2) LEFT JOIN {0}.pov_template t3 on (t3.idParent=t2.idKey and t3.level=3)  {1}   order by industryId,level1Seq,level2Seq,level3Seq ASC
SQL_QUERY_INDUSTRY=SELECT  tt.idKey,tt.title,tt.downloadURL,tt.mobileURL, Upper(date_format((select max(t.lastUpdated) from {0}.pov_template t where find_in_set(t.idKey, {0}.queryTemplateChildren(tt.idKey))>0 ),"%d%b%Y")) lastUpdate, case when  tt.idKey in (select idParent from  {0}.pov_template) then 1 else 0 end hasChild FROM {0}.pov_template tt  WHERE tt.idParent=0 order by tt.sequenceNumber+0 ASC
SQL_Query_TEMPLATE_WHERE=WHERE tt.idKey=?